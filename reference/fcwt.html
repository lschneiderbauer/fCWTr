<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fast continuous wavelet transform — fcwt • fCWTr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fast continuous wavelet transform — fcwt"><meta name="description" content="The core function of this package making use of the fCWT library. It processes
an input signal in form of a real valued numeric vector interpreted as an
evenly spaced time series and returns the absolute values of the continuous
wavelet transform,  i.e. a real valued positive matrix with a time and a
frequency dimension."><meta property="og:description" content="The core function of this package making use of the fCWT library. It processes
an input signal in form of a real valued numeric vector interpreted as an
evenly spaced time series and returns the absolute values of the continuous
wavelet transform,  i.e. a real valued positive matrix with a time and a
frequency dimension."><meta property="og:image" content="https://lschneiderbauer.github.io/fcwtr/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fCWTr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/sigma.html">Controlling the time/frequency resolution</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lschneiderbauer/fCWTr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fast continuous wavelet transform</h1>
      <small class="dont-index">Source: <a href="https://github.com/lschneiderbauer/fCWTr/blob/master/R/fcwt.R" class="external-link"><code>R/fcwt.R</code></a></small>
      <div class="d-none name"><code>fcwt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The core function of this package making use of the fCWT library. It processes
an input signal in form of a real valued numeric vector interpreted as an
evenly spaced time series and returns the absolute values of the continuous
wavelet transform,  i.e. a real valued positive matrix with a time and a
frequency dimension.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fcwt</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">x_sample_freq</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>,</span>
<span>  y_sample_freq <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fu"><a href="sigma_res.html">sigma_res</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">freq_end</span><span class="op">)</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  freq_begin <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">x_sample_freq</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  freq_end <span class="op">=</span> <span class="va">x_sample_freq</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  n_freqs <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="du.html">du</a></span><span class="op">(</span><span class="va">freq_end</span><span class="op">/</span><span class="va">freq_begin</span><span class="op">)</span>, base <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="sigma_freq_res_rel.html">sigma_freq_res_rel</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  freq_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"linear"</span><span class="op">)</span>,</span>
<span>  rm_coi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Real-valued time series. The time steps are assumed to be evenly spaced.</p></dd>


<dt id="arg-x-sample-freq">x_sample_freq<a class="anchor" aria-label="anchor" href="#arg-x-sample-freq"></a></dt>
<dd><p>Sampling rate of input time series <code>x</code>. This number primarily establishes
a connection to physical units which is used in other frequency definitions
as well as the units of the output data. Expects either a value with frequency
units, generated with <code><a href="u.html">u()</a></code>, or a pure number, in which case it is
interpreted in units of 'Hertz'.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Sets a dimensionless parameter \(\Sigma\) controlling the wavelet spread.
Changing this parameter adjusts the time/frequency uncertainty balance,
\(\Delta t = 4 \frac{\Sigma}{f}\), \(\Delta f = 4 \frac{f}{2\pi \Sigma}\).
Larger (lower) value of sigma corresponds to a better (worse) frequency
resolution and a worse (better) time resolution.</p>
<p>For more information, see <code><a href="../articles/sigma.html">vignette("sigma", package = "fCWTr")</a></code>).</p>
<p>Defaults to \(2\pi\). Note that there is not really a natural choice for
sigma, it depends on the use case. So the default choice can very well be
quite a bad choice (it probably is for audio data).</p></dd>


<dt id="arg-y-sample-freq">y_sample_freq<a class="anchor" aria-label="anchor" href="#arg-y-sample-freq"></a></dt>
<dd><p>Sampling rate of output time series, in frequency units (see <code><a href="u.html">u()</a></code>).
The default value is set so that it aligns with the physical time resolution
of the highest frequency modes.
The maximum allowed sampling rate is the sampling rate of the input signal
<code>x_sample_freq</code>.</p></dd>


<dt id="arg-freq-begin-freq-end">freq_begin, freq_end<a class="anchor" aria-label="anchor" href="#arg-freq-begin-freq-end"></a></dt>
<dd><p>Optionally specifies the frequency range <code>[freq_end, freq_begin]</code>. If not
specified the maximal meaningful frequency range, depending on the input signal,
is taken.
A frequency-valued number, generated with <code><a href="u.html">u()</a></code>, or a pure number, that is
interpreted in units of 'Hertz'.</p></dd>


<dt id="arg-n-freqs">n_freqs<a class="anchor" aria-label="anchor" href="#arg-n-freqs"></a></dt>
<dd><p>Number of frequency bins generated by the CWT. The frequencies
are linearly or logarithmically distributed, depending on the <code>freq_scale</code>
argument. Computation time increases when raising the
number of frequency bins.
The default number is chosen such that the frequency bandwidths are of the
size of the physical frequency resolutions in case of a logarithmic scale.
In some sense this value constitutes the "physical" limit.
However, increasing <code>n_freqs</code> beyond this limit can still make sense: If
we have a signal of a precise frequency, and the probing frequency band is
not exactly aligned, the output signal will be dampened. In this case it
can be useful to increase <code>n_freqs</code> and perform appropriate averaging
afterwards: the output signal will show improved response.</p></dd>


<dt id="arg-freq-scale">freq_scale<a class="anchor" aria-label="anchor" href="#arg-freq-scale"></a></dt>
<dd><p>( <code>"log"</code> | <code>"linear"</code> )
Should the frequency scale be linear or logarithmic?
"linear"  / "log" for linear / logarithmic.
The default scale is logarithmic since differences on a logarithmic scale
are proportional to the frequency uncertainties.
In this sense, the logarithmic frequency scale is actually the natural
scale for the continuous wavelet transform.</p></dd>


<dt id="arg-rm-coi">rm_coi<a class="anchor" aria-label="anchor" href="#arg-rm-coi"></a></dt>
<dd><p>( <a href="https://rdrr.io/r/base/logical.html" class="external-link">TRUE</a> | <a href="https://rdrr.io/r/base/logical.html" class="external-link">FALSE</a> )
Boundary effects can result in nonphysical artifacts. If <code>rm_coi = TRUE</code>,
those are effectively removed by setting corresponding values to <a href="https://rdrr.io/r/base/NA.html" class="external-link">NA</a>.
We define the essential support of the
(Gaussian) wavelet to be four times its standard deviation,
\(\Delta t = \frac{\sigma}{f}\), and so a wavelet touches
the boundary if the distance of the center of the wavelet to the boundary
is less then \(\Delta t /2\). Values that fall into that range are removed
if <code>rm_coi = TRUE</code>.</p></dd>


<dt id="arg-n-threads">n_threads<a class="anchor" aria-label="anchor" href="#arg-n-threads"></a></dt>
<dd><p>Number of threads used by the computation, if supported by your platform.
Defaults to 2 threads (to accommodate CRAN requirements).
If <code><a href="openmp_enabled.html">openmp_enabled()</a></code> returns <code>FALSE</code>, this argument is ignored, and
only a single thread is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The spectogram, a numeric real-valued matrix with dimensions
<code>dim = c(length(x), n_freqs)</code>, curated with some additional properties.
This matrix is wrapped into a S3-class <code>fcwtr_scalogram</code> so that plotting and
coercion functions can be used conveniently. Use <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix()</a></code> to strip
the curated information. Or use <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> to convert to another
data format.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The wavelet used in this calculation is the so called Morlet wavelet,
a sinusoidal wave modulated by a Gaussian whose spread is controlled by
the argument <code>sigma</code>.</p>
<p>See the original paper
Arts, L.P.A., van den Broek, E.L.
The fast continuous wavelet transformation (fCWT) for real-time, high-quality,
noise-resistant time–frequency analysis.
Nat Comput Sci 2, 47–58 (2022). <a href="https://doi.org/10.1038/s43588-021-00183-z" class="external-link">doi:10.1038/s43588-021-00183-z</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fcwt_batch.html">fcwt_batch()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ts_sin_440</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="fl">440</span> <span class="op">/</span> <span class="fl">44100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fcwt</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ts_sin_440</span>,</span></span>
<span class="r-in"><span>  x_sample_freq <span class="op">=</span> <span class="fu"><a href="u.html">u</a></span><span class="op">(</span><span class="fl">44.1</span>, <span class="st">"kHz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigma <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  freq_begin <span class="op">=</span> <span class="fu"><a href="u.html">u</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"Hz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  freq_end <span class="op">=</span> <span class="fu"><a href="u.html">u</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="st">"Hz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_freqs <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> _Scalogram_</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * (Time/Frequency) dimension:  ( 18 , 10 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Sampling rate: 150 [Hz]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Frequency scale: 50 [Hz] - 1000 [Hz], log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Time offset: 0 [s] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Sigma: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   o Time resolution at  50 [Hz] :  0.4 [1/Hz] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   o Time resolution at  1000 [Hz] :  0.02 [1/Hz] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   o Relative frequency resolution:  0.127324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Time/frequency matrix summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.00000 0.00000 0.00000 0.00001 0.00001 0.00023     114 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Schneiderbauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

