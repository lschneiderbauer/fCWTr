<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Performs a fast continuous wavelet transform on long sequences. It should
not be used on short sequences since boundary artefacts are discarded (and
those potentially dominate for short sequences.)"><title>Automatic batching of fcwt calculations on long sequences — fcwt_batch • fcwtr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automatic batching of fcwt calculations on long sequences — fcwt_batch"><meta property="og:description" content="Performs a fast continuous wavelet transform on long sequences. It should
not be used on short sequences since boundary artefacts are discarded (and
those potentially dominate for short sequences.)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fcwtr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Automatic batching of fcwt calculations on long sequences</h1>
      
      <div class="d-none name"><code>fcwt_batch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs a fast continuous wavelet transform on long sequences. It should
not be used on short sequences since boundary artefacts are discarded (and
those potentially dominate for short sequences.)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fcwt_batch</span><span class="op">(</span></span>
<span>  <span class="va">signal</span>,</span>
<span>  <span class="va">sample_freq</span>,</span>
<span>  <span class="va">freq_begin</span>,</span>
<span>  <span class="va">freq_end</span>,</span>
<span>  <span class="va">n_freqs</span>,</span>
<span>  <span class="va">sigma</span>,</span>
<span>  max_batch_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fl">9</span><span class="op">/</span><span class="op">(</span><span class="va">n_freqs</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">time_resolution</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="fl">8L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>signal</dt>
<dd><p>Real-valued time series. The time step gaps are assumed to be evenly spaced.</p></dd>


<dt>sample_freq</dt>
<dd><p>Sampling rate of input time series in physical units.</p></dd>


<dt>freq_begin</dt>
<dd><p>Sets the minimal frequency (<code>&gt; 0</code>), in same units as <code>sample_freq</code>,
that should be contained in the output.</p></dd>


<dt>freq_end</dt>
<dd><p>Sets the maximal frequency (<code>&gt; freq_begin</code>), in same units as
<code>sample_freq</code>, that should be contained in the output.</p></dd>


<dt>n_freqs</dt>
<dd><p>Number of frequency bins generated by the CWT. The frequencies
are linearly distributed. Computation time increases
when raising the number of frequency bins.</p></dd>


<dt>sigma</dt>
<dd><p>Sets a dimensionless parameter modifying the wavelet spread which in the
time-domain is roughly given by \(\Sigma_t \sim \sqrt{2} \frac{\sigma}{f}\).
Changing this parameter adjusts the time/frequency uncertainty balance.
Defaults to 1.
Larger (lower) value of sigma corresponds to a better (worse) frequency
resolution and a worse (better) time resolution.</p></dd>


<dt>max_batch_size</dt>
<dd><p>The maximal batch size that is used for splitting up the input sequence.
This limits the maximal memory that is used. Defaults to roughly 4GB.
The actual batch size is optimized for use with FFTW.</p></dd>


<dt>time_resolution</dt>
<dd><p>The time resolution in inverse units of <code>sample_freq</code> of the result.
Memory consumption is directly related to that.
Can not be higher than the time resolution of the input signal.</p></dd>


<dt>nthreads</dt>
<dd><p>Number of threads used by the computation, if applicable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In case of input sequences that exceed the a certain size, the output
sequence will not fit into the local memory and the fcwt cannot be
performed in one run.
For instance, in case of processing a song of 10 minutes length (assuming
a sampling rate of 44100 Hz), the size of the output vector is
<code>10 * 60 seconds * 44100 Hz * nfreqs * 4 bytes</code>,
which for e.g. <code>nfreqs = 200</code>, equals ~ 21 GB, hence
nowadays already at the limit of the hardware of a modern personal computer.</p>
<p>In cases where the needed output time-resolution is smaller than the time
resolution of the input signal, one can perform the fcwt and reduce the
output size by averaging.
(The input signal time resolution can in general not be reduced since
high-frequency information would get lost.)</p>
<p>This function splits up the input sequence into batches, processes each
batch separately, reduces the time resolution, and adds the outputs together.</p>
<p>Attention: Boundary artefacts are removed, so some high frequency information
at the beginning and the end of the sequence is lost. (The amount depends on
the minimal frequency captured <code>min_freq</code>.)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>fcwt</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">fcwt_batch</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">ts_sin_sin</span>,</span></span>
<span class="r-in"><span>    sample_freq <span class="op">=</span> <span class="fl">44100</span>,</span></span>
<span class="r-in"><span>    freq_begin <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    freq_end <span class="op">=</span> <span class="fl">11000</span>,</span></span>
<span class="r-in"><span>    n_freqs <span class="op">=</span> <span class="fl">300</span>,</span></span>
<span class="r-in"><span>    sigma <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    max_batch_size <span class="op">=</span> <span class="fl">20000</span>,</span></span>
<span class="r-in"><span>    time_resolution <span class="op">=</span> <span class="fl">0.001</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======                                                                |   9%  |                                                                              |=============                                                         |  18%  |                                                                              |===================                                                   |  27%  |                                                                              |=========================                                             |  36%  |                                                                              |===============================                                       |  45%  |                                                                              |======================================                                |  54%  |                                                                              |============================================                          |  63%  |                                                                              |==================================================                    |  72%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Schneiderbauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

